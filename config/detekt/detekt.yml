build:
  maxIssues: 0
  weights:
    complexity: 2
    style: 1

config:
  validation: true
  warningsAsErrors: true

# REGLAS DE DOCUMENTACIÓN Y COMENTARIOS
comments:
  active: true
  # SQAP: Documentación obligatoria en API pública (KDoc)
  UndocumentedPublicClass:
    active: true
  UndocumentedPublicFunction:
    active: true
    excludes: ["**/*Test.kt", "**/test/**", "**/androidTest/**"]

# MÉTRICAS DE MANTENIBILIDAD (MVVM)
complexity:
  active: true
  # Evitar ViewModels o Repositorios excesivamente complejos
  CyclomaticComplexMethod:
    active: true
    threshold: 15
  LongMethod:
    active: true
    threshold: 60
  LargeClass:
    active: true
    threshold: 300 # Límite para evitar "God Objects"
  TooManyFunctions:
    active: true
    thresholdInClasses: 15

# ESTÁNDARES DE NOMBRADO
naming:
  active: true
  PackageNaming:
    active: true
    packagePattern: '[a-z]+(\.[a-z][a-z0-9]*)*'
  # Naming estricto para LiveData/StateFlow (is..., has..., etc)
  BooleanPropertyNaming:
    active: true
    allowedPattern: '^(is|has|should|can|must)[A-Z].*'

# REGLAS DE ARQUITECTURA MVVM (CRÍTICO)
style:
  active: true

  # Calidad de entregas: Prohibido dejar notas temporales
  # (Detekt 1.23.x: ForbiddenComment está en "style" y usa "comments" como regex)
  ForbiddenComment:
    active: true
    comments:
      - "TODO:.*"
      - "FIXME:.*"
      - "STOPSHIP:.*"

  # MVVM: Los ViewModels NO deben conocer la Vista (Context, View, Resources)
  ForbiddenImport:
    active: true
    imports:
      - "android.content.Context"
      - "android.view.View"
      - "android.content.res.Resources"
      - "android.widget.*"
    excludes:
      - "**/ui/**"
      - "**/*Fragment.kt"
      - "**/*Activity.kt"
      - "**/*Adapter.kt"

  # Fomentar la inmutabilidad en el State del ViewModel
  VarCouldBeVal:
    active: true
  DataClassShouldBeImmutable:
    active: true

  # Evitar lógica oculta en funciones de una sola línea
  ExpressionBodySyntax:
    active: true

# REGLAS PARA CAPA DE DATOS Y ERRORES
potential-bugs:
  active: true
  # Evitar que colecciones mutables se expongan desde el Repositorio
  DoubleMutabilityForCollection:
    active: true
  # Lateinit permitido solo donde el ciclo de vida de Android lo exige
  LateinitUsage:
    active: true
    excludes: ["**/ui/**", "**/*Fragment.kt", "**/*Activity.kt"]

exceptions:
  active: true
  # Obligar a un manejo de errores específico en el ViewModel/UseCases
  TooGenericExceptionCaught:
    active: true
    exceptionNames: ["Error", "Exception", "Throwable"]
  SwallowedException:
    active: true

# FORMATO FINAL (requiere detekt-formatting)
formatting:
  active: true
  Indentation:
    active: true
    indentSize: 4
  MaximumLineLength:
    active: true
    maxLineLength: 120